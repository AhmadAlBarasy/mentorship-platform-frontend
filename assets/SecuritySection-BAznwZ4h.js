import{c as N,r as x,h as k,j as e,v as P,z as g,B as h,S as v}from"./index-DjaPym5F.js";import{h as S,i as _}from"./useSettings-Dv_Sh4bq.js";import{P as C}from"./PasswordStrengthIndicator-BWriWpoK.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],E=N("key",A);function M({user:s}){const[o,w]=x.useState(!1),[l,b]=x.useState(!1),{register:c,handleSubmit:y,watch:m,reset:f,formState:{errors:d}}=k(),r=S(),n=_(),t=m("newPassword",""),i=m("confirmPassword",""),u=async a=>{if(a.newPassword===a.confirmPassword)try{await r.mutateAsync({password:a.newPassword}),f()}catch(p){console.error("Password change failed:",p)}},j=async()=>{try{await n.mutateAsync(!s.is_2fa_enabled)}catch(a){console.error("2FA toggle failed:",a)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Security Settings"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your password and two-factor authentication settings."})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(E,{className:"w-5 h-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Change Password"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Update your password to keep your account secure"})]})]}),e.jsxs("form",{onSubmit:y(u),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",...c("newPassword",P.password),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>w(!o),children:o?e.jsx(g,{className:"w-5 h-5 text-gray-400"}):e.jsx(h,{className:"w-5 h-5 text-gray-400"})})]}),d.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.newPassword.message}),e.jsx(C,{password:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:l?"text":"password",...c("confirmPassword",{required:"Please confirm your new password",validate:a=>a===t||"Passwords do not match"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Confirm your new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!l),children:l?e.jsx(g,{className:"w-5 h-5 text-gray-400"}):e.jsx(h,{className:"w-5 h-5 text-gray-400"})})]}),d.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.confirmPassword.message}),i&&e.jsx("div",{className:"mt-2 text-sm",children:t===i?e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"✓ Passwords match"}):e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"✗ Passwords do not match"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:r.isPending||!t||t!==i,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-md transition-colors disabled:cursor-not-allowed",children:r.isPending?"Changing...":"Change Password"})}),r.isSuccess&&e.jsx("div",{className:"rounded-md bg-green-50 dark:bg-green-900/20 p-4",children:e.jsx("div",{className:"text-sm text-green-700 dark:text-green-400",children:"Password changed successfully!"})}),r.error&&e.jsx("div",{className:"rounded-md bg-red-50 dark:bg-red-900/20 p-4",children:e.jsx("div",{className:"text-sm text-red-700 dark:text-red-400",children:r.error.message})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"w-5 h-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Add an extra layer of security to your account"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:j,disabled:!0,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${s!=null&&s.is_2fa_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s!=null&&s.is_2fa_enabled?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-white",children:s!=null&&s.is_2fa_enabled?"Enabled":"Disabled"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:`p-4 rounded-md ${s!=null&&s.is_2fa_enabled?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800"}`,children:e.jsx("p",{className:`text-sm ${s!=null&&s.is_2fa_enabled?"text-green-700 dark:text-green-400":"text-yellow-700 dark:text-yellow-400"}`,children:"Two-factor authentication will be implemented soon."})})}),n.isPending&&e.jsxs("div",{className:"mt-4 text-sm text-blue-600 dark:text-blue-400",children:[s!=null&&s.is_2fa_enabled?"Disabling...":"Enabling..."," two-factor authentication..."]}),n.error&&e.jsx("div",{className:"mt-4 rounded-md bg-red-50 dark:bg-red-900/20 p-4",children:e.jsx("div",{className:"text-sm text-red-700 dark:text-red-400",children:n.error.message})})]})]})]})}export{M as default};
